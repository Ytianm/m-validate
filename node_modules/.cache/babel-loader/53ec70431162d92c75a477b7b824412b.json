{"remainingRequest":"/Users/ytm/Documents/web/Vue/validate/node_modules/babel-loader/lib/index.js!/Users/ytm/Documents/web/Vue/validate/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/ytm/Documents/web/Vue/validate/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/ytm/Documents/web/Vue/validate/src/form/m-form-item.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/ytm/Documents/web/Vue/validate/src/form/m-form-item.vue","mtime":1575213213656},{"path":"/Users/ytm/Documents/web/Vue/validate/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/ytm/Documents/web/Vue/validate/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/ytm/Documents/web/Vue/validate/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/ytm/Documents/web/Vue/validate/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCBfZGVmaW5lUHJvcGVydHkgZnJvbSAiL1VzZXJzL3l0bS9Eb2N1bWVudHMvd2ViL1Z1ZS92YWxpZGF0ZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vZGVmaW5lUHJvcGVydHkiOwovLwovLwovLwovLwovLwovLwovLwppbXBvcnQgU2NoZW1hIGZyb20gImFzeW5jLXZhbGlkYXRvciI7CmV4cG9ydCBkZWZhdWx0IHsKICBpbmplY3Q6IFsiZm9ybSJdLAogIC8vIOazqOWFpWZvcm0gIOiOt+WPluWIsCBmb3JtIOeahCBtb2RlbCDku6Xlj4ogcnVsZXMKICBwcm9wczogewogICAgbGFiZWw6IHsKICAgICAgdHlwZTogU3RyaW5nLAogICAgICBkZWZhdWx0OiAiIgogICAgfSwKICAgIHByb3A6IHsKICAgICAgdHlwZTogU3RyaW5nLAogICAgICBkZWZhdWx0OiAiIgogICAgfQogIH0sCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHZhbGlkYXRlU3RhdHVzOiAiIiwKICAgICAgdmFsaWRhdGVNc2c6ICIiLAogICAgICBlcnJvckNsYXNzOiAnICcKICAgIH07CiAgfSwKICBtZXRob2RzOiB7CiAgICB2YWxpZGF0ZTogZnVuY3Rpb24gdmFsaWRhdGUoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvLyDkvb/nlKggYXN5bmMtdmFsaWRhdG9yIOi/m+ihjOagoemqjAogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHsKICAgICAgICBjb25zb2xlLmxvZygidmFsaWRhdGUgLS0gaW5wdXQg6YCa55+l5oiR5qCh6aqM5pWw5o2u5LqGIiwgX3RoaXMuZm9ybS5tb2RlbFtfdGhpcy5wcm9wXSk7IC8vIOagoemqjOinhOWImQoKICAgICAgICB2YXIgZGVzY3JpcHRvciA9IF9kZWZpbmVQcm9wZXJ0eSh7fSwgX3RoaXMucHJvcCwgX3RoaXMuZm9ybS5ydWxlc1tfdGhpcy5wcm9wXSk7IC8vIOagoemqjOWZqAoKCiAgICAgICAgdmFyIHZhbGlkYXRvciA9IG5ldyBTY2hlbWEoZGVzY3JpcHRvcik7IC8vIOW8gOWni+agoemqjOaVsOaNrgoKICAgICAgICB2YWxpZGF0b3IudmFsaWRhdGUoX2RlZmluZVByb3BlcnR5KHt9LCBfdGhpcy5wcm9wLCBfdGhpcy5mb3JtLm1vZGVsW190aGlzLnByb3BdKSwgZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgICBpZiAoZXJyb3IpIHsKICAgICAgICAgICAgX3RoaXMudmFsaWRhdGVTdGF0dXMgPSAiZXJyb3IiOwogICAgICAgICAgICBfdGhpcy52YWxpZGF0ZU1zZyA9IGVycm9yWzBdLm1lc3NhZ2U7CiAgICAgICAgICAgIF90aGlzLmVycm9yQ2xhc3MgPSAnaXMtZXJyb3InOwogICAgICAgICAgICByZXNvbHZlKGZhbHNlKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIF90aGlzLnZhbGlkYXRlU3RhdHVzID0gIiI7CiAgICAgICAgICAgIF90aGlzLnZhbGlkYXRlTXNnID0gIiI7CiAgICAgICAgICAgIF90aGlzLmVycm9yQ2xhc3MgPSAnJzsKICAgICAgICAgICAgcmVzb2x2ZSh0cnVlKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CiAgfSwKICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgLy8g5qCh5rWL5Yiw5p2l5q2kIExJbnB1dCDnmoTmo4DmtYvor7fmsYIKICAgIHRoaXMuJG9uKCJ2YWxpZGF0ZSIsIHRoaXMudmFsaWRhdGUpOwogIH0sCiAgbW91bnRlZDogZnVuY3Rpb24gbW91bnRlZCgpIHsKICAgIC8vIOaMgui9veWIsGZvcm3kuIrml7bvvIzmtL7lj5HkuIDkuKrmt7vliqDkuovku7YKICAgIC8vIOWmguaenOatpOe7hOS7tuS8oOWFpeS6hiBwcm9wcyDvvIzliJnpnIDopoHpgJrnn6XniLbnu4Tku7Yg5Lul5pS+5YWl5qOA5rWL5pWw57uECiAgICBpZiAodGhpcy5wcm9wKSB7CiAgICAgIHRoaXMuJHBhcmVudC4kZW1pdCgiZm9ybUl0ZW1BZGQiLCB0aGlzKTsKICAgIH0KICB9Cn07"},{"version":3,"sources":["m-form-item.vue"],"names":[],"mappings":";;;;;;;;;AAQA,OAAA,MAAA,MAAA,iBAAA;AACA,eAAA;AACA,EAAA,MAAA,EAAA,CAAA,MAAA,CADA;AACA;AACA,EAAA,KAAA,EAAA;AACA,IAAA,KAAA,EAAA;AACA,MAAA,IAAA,EAAA,MADA;AAEA,MAAA,OAAA,EAAA;AAFA,KADA;AAKA,IAAA,IAAA,EAAA;AACA,MAAA,IAAA,EAAA,MADA;AAEA,MAAA,OAAA,EAAA;AAFA;AALA,GAFA;AAYA,EAAA,IAZA,kBAYA;AACA,WAAA;AACA,MAAA,cAAA,EAAA,EADA;AAEA,MAAA,WAAA,EAAA,EAFA;AAGA,MAAA,UAAA,EAAA;AAHA,KAAA;AAKA,GAlBA;AAmBA,EAAA,OAAA,EAAA;AACA,IAAA,QADA,sBACA;AAAA;;AACA;AACA,aAAA,IAAA,OAAA,CAAA,UAAA,OAAA,EAAA;AACA,QAAA,OAAA,CAAA,GAAA,CACA,4BADA,EAEA,KAAA,CAAA,IAAA,CAAA,KAAA,CAAA,KAAA,CAAA,IAAA,CAFA,EADA,CAKA;;AACA,YAAA,UAAA,uBACA,KAAA,CAAA,IADA,EACA,KAAA,CAAA,IAAA,CAAA,KAAA,CAAA,KAAA,CAAA,IAAA,CADA,CAAA,CANA,CAUA;;;AACA,YAAA,SAAA,GAAA,IAAA,MAAA,CAAA,UAAA,CAAA,CAXA,CAaA;;AACA,QAAA,SAAA,CAAA,QAAA,qBACA,KAAA,CAAA,IADA,EACA,KAAA,CAAA,IAAA,CAAA,KAAA,CAAA,KAAA,CAAA,IAAA,CADA,GAEA,UAAA,KAAA,EAAA;AACA,cAAA,KAAA,EAAA;AACA,YAAA,KAAA,CAAA,cAAA,GAAA,OAAA;AACA,YAAA,KAAA,CAAA,WAAA,GAAA,KAAA,CAAA,CAAA,CAAA,CAAA,OAAA;AACA,YAAA,KAAA,CAAA,UAAA,GAAA,UAAA;AACA,YAAA,OAAA,CAAA,KAAA,CAAA;AACA,WALA,MAKA;AACA,YAAA,KAAA,CAAA,cAAA,GAAA,EAAA;AACA,YAAA,KAAA,CAAA,WAAA,GAAA,EAAA;AACA,YAAA,KAAA,CAAA,UAAA,GAAA,EAAA;AACA,YAAA,OAAA,CAAA,IAAA,CAAA;AACA;AACA,SAdA;AAgBA,OA9BA,CAAA;AA+BA;AAlCA,GAnBA;AAuDA,EAAA,OAvDA,qBAuDA;AACA;AACA,SAAA,GAAA,CAAA,UAAA,EAAA,KAAA,QAAA;AACA,GA1DA;AA2DA,EAAA,OA3DA,qBA2DA;AACA;AACA;AACA,QAAA,KAAA,IAAA,EAAA;AACA,WAAA,OAAA,CAAA,KAAA,CAAA,aAAA,EAAA,IAAA;AACA;AACA;AAjEA,CAAA","sourcesContent":["<template>\n  <div class=\"m-form-item\" :class=\"errorClass\">\n    <label v-if=\"label\">{{label}}</label>\n    <slot></slot>\n    <span style=\"color: red\" v-if=\"validateStatus === 'error'\">{{validateMsg}}</span>\n  </div>\n</template>\n<script>\nimport Schema from \"async-validator\";\nexport default {\n  inject: [\"form\"], // 注入form  获取到 form 的 model 以及 rules\n  props: {\n    label: {\n      type: String,\n      default: \"\"\n    },\n    prop: {\n      type: String,\n      default: \"\"\n    }\n  },\n  data() {\n    return {\n      validateStatus: \"\",\n      validateMsg: \"\",\n      errorClass: ' '\n    };\n  },\n  methods: {\n    validate() {\n      // 使用 async-validator 进行校验\n      return new Promise(resolve => {\n        console.log(\n          \"validate -- input 通知我校验数据了\",\n          this.form.model[this.prop]\n        );\n        // 校验规则\n        let descriptor = {\n          [this.prop]: this.form.rules[this.prop]\n        };\n\n        // 校验器\n        let validator = new Schema(descriptor);\n\n        // 开始校验数据\n        validator.validate(\n          { [this.prop]: this.form.model[this.prop] },\n          error => {\n            if (error) {\n              this.validateStatus = \"error\";\n              this.validateMsg = error[0].message;\n              this.errorClass = 'is-error';\n              resolve(false);\n            } else {\n              this.validateStatus = \"\";\n              this.validateMsg = \"\";\n              this.errorClass = '';\n              resolve(true);\n            }\n          }\n        );\n      });\n    }\n  },\n  created() {\n    // 校测到来此 LInput 的检测请求\n    this.$on(\"validate\", this.validate);\n  },\n  mounted() {\n    // 挂载到form上时，派发一个添加事件\n    // 如果此组件传入了 props ，则需要通知父组件 以放入检测数组\n    if (this.prop) {\n      this.$parent.$emit(\"formItemAdd\", this);\n    }\n  }\n};\n</script>"],"sourceRoot":"src/form"}]}